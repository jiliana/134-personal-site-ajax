<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Method Test</title>
  </head>
  <body>
    <form id="form" action="https://httpbin.org/" method="post">
      <label for="id">ID:</label><br />
      <input type="number" name="id" id="id" />
      <br />
      <label for="article_name">Article Name:</label><br />
      <input type="text" name="article_name" id="article_name" />
      <br />
      <label for="article_body">Article Body:</label><br />
      <textarea
        name="article_body"
        id="article_body"
        cols="30"
        rows="5"
      ></textarea>
      <br />
      <p id="date"></p>

      <button type="submit" name="action" id="postBtn">POST</button>
      <button type="submit" name="action" id="getBtn">GET</button>
      <button type="submit" name="action" id="putBtn">PUT</button>
      <button type="submit" name="action" id="deleteBtn">DELETE</button>
    </form>

    <output id="response"></output>

    <script>
      function updateDate() {
        const d = new Date();
        const date = document.getElementById("date");
        date.innerHTML = d;
      }
      setInterval(updateDate, 1000);

      const form = document.querySelector("form");
      const postBtn = document.getElementById("postBtn");
      const getBtn = document.getElementById("getBtn");
      const putBtn = document.getElementById("putBtn");
      const deleteBtn = document.getElementById("deleteBtn");
      var output = document.getElementById("response");

      getBtn.addEventListener("click", function (e) {
        e.preventDefault();
        var xhr = new XMLHttpRequest();
        xhr.open("GET", form.action);
        xhr.onload = function () {
          var response = JSON.parse(xhr.responseText);
          output.textContent = JSON.stringify(response, null, 2);
        };
        xhr.send();
      });

      postBtn.addEventListener("click", function (e) {
        e.preventDefault();
        const xhr = new XMLHttpRequest();
        xhr.open("POST", 'https://httpbin.org/post', true);

        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");

        xhr.onreadystatechange = () => { // Call a function when the state changes.
          if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
            var response = JSON.parse(xhr.responseText);
            var strResponse = (JSON.stringify(response, null, 2));
            strResponse = strResponse.replace(/(?:\\[rn]|[\r\n]+)+/g, '</br>');
            output.innerHTML = strResponse;
            
          }
        }
        xhr.send(new FormData(form));
      });

      // putBtn.addEventListener("click", function (e) {
      //   e.preventDefault();
      //   var xhr = new XMLHttpRequest();
      //   xhr.open("PUT", form.action);
      //   xhr.setRequestHeader(
      //     "Content-Type",
      //     "application/x-www-form-urlencoded"
      //   );
      //   xhr.onload = function () {
      //     var response = JSON.parse(xhr.responseText);
      //   };
      //   xhr.send(new FormData(form));
      // });

      // deleteBtn.addEventListener("click", function (e) {
      //   e.preventDefault();
      //   var xhr = new XMLHttpRequest();
      //   xhr.open("DELETE", form.action);
      //   xhr.setRequestHeader(
      //     "Content-Type",
      //     "application/x-www-form-urlencoded"
      //   );
      //   xhr.onload = function () {
      //     var response = JSON.parse(xhr.responseText);
      //     output.textContent = JSON.stringify(response, null, 2);
      //   };
      //   xhr.send(new FormData(form));
      // });
    </script>
  </body>
</html>
